<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Philippine Financial Institutions Chatbot</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
            color: #333;
        }
        h1 {
            color: #4CAF50;
            font-size: 2.5em;
        }
        h2 {
            margin-top: 20px;
            color: #333;
        }
        .subtitle {
            font-size: 1.2em;
            color: #777;
            margin-bottom: 20px;
        }
        form {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        input[type="text"] {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        input[type="submit"] {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        input[type="submit"]:hover {
            background-color: #45a049;
        }
        pre {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
    <h1>Philippine Financial Institutions Chatbot</h1>
    <div class="subtitle">
        You can query cities, provinces, and select statistics (e.g., mean, max, min). The chatbot will provide the total number of Financial Institutions based on the Bangko Sentral ng Pilipinas' March 2024 physical networks.
    </div>
    <form id="chatbotForm">
        <label for="query">Ask a question:</label><br>
        <input type="text" id="query" name="query" placeholder="e.g. How many FIs are in Manila?" required><br><br>
        <input type="submit" value="Submit">
    </form>
    <h2>Response:</h2>
    <pre id="response"></pre>

    <script>
        document.getElementById("chatbotForm").addEventListener("submit", async function(event) {
            event.preventDefault();
            
            const query = document.getElementById("query").value;
            const responseElement = document.getElementById("response");

            // Send POST request to your Flask chatbot API
            try {
                const response = await fetch("https://worker-production-1784.up.railway.app/chatbot", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({ query: query }),
                });

                // Parse the JSON response from the server
                const data = await response.json();
                
                // Clean and format the response string without JSON brackets
                if (typeof data === 'object') {
                    if (Array.isArray(data)) {
                        const result = data.map(item => 
                            `${item.Cities || ''}, ${item.Province || ''}: ${item['Total Number of Fis'] || ''} FIs`
                        ).join("\n");
                        responseElement.textContent = result || 'No data found';
                    } else {
                        responseElement.textContent = 'No data found';
                    }
                } else {
                    responseElement.textContent = data;
                }
            } catch (error) {
                responseElement.textContent = "Error: Could not connect to chatbot.";
            }
        });
    </script>
</body>
</html>
